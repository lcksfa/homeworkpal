执行RAG项目的安全回滚和系统恢复。当出现严重错误、功能回归或环境损坏时使用，快速恢复到已知的稳定状态。

回滚场景判断：
1. 严重系统问题
   - 后端服务无法启动
   - 向量数据库损坏或无法连接
   - 文档处理管道完全失效
   - 前端界面完全无法访问

2. 功能严重回归
   - 核心检索功能失效
   - 生成回答质量严重下降
   - 用户交互出现严重错误
   - 性能严重退化（响应时间>10秒）

3. 环境损坏
   - Python虚拟环境损坏
   - 依赖包版本冲突
   - 配置文件丢失或损坏
   - 数据目录权限问题

恢复流程：
1. 问题诊断
   - 运行系统健康检查脚本
   - 分析最近的git变更历史
   - 检查错误日志和异常信息
   - 确定问题的根本原因

2. 回滚策略选择
   - 安全回滚：使用git revert撤销最近变更
   - 硬回滚：重置到已知的良好提交状态
   - 环境重建：完全重新初始化开发环境
   - 部分恢复：仅回滚特定的功能模块

3. 执行回滚操作
   - 备份当前状态（如有价值的数据）
   - 执行选定的回滚策略
   - 重新初始化相关组件
   - 验证系统基本功能

4. 系统验证
   - 运行完整的E2E冒烟测试
   - 验证核心RAG流程正常工作
   - 检查数据完整性
   - 确认用户界面可用

5. 事故记录
   - 在claude-progress.txt中记录回滚事件
   - 分析问题根本原因
   - 制定预防措施
   - 更新开发流程和检查清单

使用方法：
/rag回滚恢复 [回滚类型]

回滚类型选项：
- safe：安全回滚（git revert）
- hard：硬回滚（git reset）
- env：环境重建
- auto：自动选择最佳策略

输出要求：
- 问题诊断的详细分析
- 采取的回滚措施和理由
- 恢复验证的结果
- 预防类似问题的建议
- 更新后的系统状态报告