---
name: rag-git-ops
description: 为RAG项目执行原子化提交、小步差异和干净合并。在应用变更和结束会话时使用，确保每个提交都是可回滚的、有明确目的的RAG功能改进。
allowed-tools: Git, Read, Write
---

# RAG项目Git操作规范

## 提交检查清单
- 清晰的标题：实现<功能ID>：<功能描述>
- 提交信息包含：作用范围、差异摘要、E2E证据、已知问题、下一步计划
- 小步原子化提交；避免无关变更混合

## RAG项目提交信息格式

### 提交标题格式
```
<类型>(<范围>): <简短描述>

类型：
- feat: 新功能（文档处理、检索算法、生成优化等）
- fix: 错误修复（检索失败、生成异常、界面问题等）
- refactor: 代码重构（不影响功能的结构优化）
- perf: 性能优化（检索速度、生成质量、内存使用等）
- test: 测试相关（冒烟测试、单元测试、E2E测试）
- docs: 文档更新（API文档、用户指南、开发文档）

范围：
- document: 文档处理相关
- retrieval: 检索功能相关
- generation: 生成功能相关
- ui: 用户界面相关
- vector: 向量数据库相关
- api: API接口相关
```

### 提交信息正文模板
```
## 变更范围
- 影响的模块：文档处理管道 / 向量检索 / LLM生成 / 前端界面
- 主要变更：算法调整 / 接口修改 / 性能优化 / 错误修复

## RAG流程影响
- 文档处理：分段策略 / 向量化方法 / 元数据提取
- 检索过程：相似度计算 / 排序算法 / 过滤条件
- 生成质量：上下文管理 / Prompt优化 / 结果验证

## 测试证据
- 冒烟测试：通过/失败
- 功能验证：具体测试步骤和结果
- 性能指标：响应时间、准确率提升数据
- 用户验证：浏览器自动化测试截图

## 已知问题
- 当前限制：文档格式支持 / 检索精度边界
- 临时方案：针对特定问题的workaround
- 技术债务：需要后续重构的部分

## 下一步计划
- <功能ID-2>: <下一个优先功能>
- 原因说明：为什么选择这个作为下一步
```

## 分支管理策略

### 主分支保护
- main分支始终保持可部署状态
- 所有功能通过pull request合并
- 强制代码审查和自动化测试

### 功能分支命名
```
feature/RAG-XXX-功能简述
fix/RAG-XXX-问题描述
refactor/模块名-重构内容
```

## 回滚策略
- 使用git revert进行安全回滚
- 保持提交历史的完整性
- 记录回滚原因到progress笔记

## RAG特定提交建议

### 算法参数调整
- 详细记录参数变更前后的数值
- 包含性能对比测试结果
- 说明参数选择的理论依据

### 模型相关变更
- 记录模型版本和配置变更
- 保存模型性能评估结果
- 文档化模型选择的原因

### 数据结构变更
- 说明数据迁移策略
- 包含向后兼容性考虑
- 记录数据一致性验证结果