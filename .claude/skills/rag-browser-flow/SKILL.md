---
name: rag-browser-flow
description: 通过浏览器自动化（Playwright/Puppeteer）执行RAG系统的用户旅程步骤。用于以人类用户的方式端到端验证RAG功能，包括文档上传、查询提交、结果展示等完整流程。
allowed-tools: Browser, Bash, Read
---

# RAG浏览器流程测试

## 指令说明
- 将功能清单中的steps[]映射到精确的浏览器操作
- 捕获屏幕截图和日志；将证据附加到提交信息或进度笔记
- 记录工具盲点；添加缓解措施（例如：文件上传对话框、下载处理）

## RAG典型用户流程

### 文档管理流程
1. 访问RAG系统主页
2. 点击"文档管理"或"上传文档"按钮
3. 选择文件类型（PDF/TXT/MD）
4. 上传测试文档
5. 验证文档已正确解析和索引
6. 查看文档元数据和处理状态

### 查询交互流程
1. 在查询输入框输入问题
2. 选择检索参数（如：检索模式、结果数量）
3. 点击"搜索"或"提问"按钮
4. 等待加载过程完成
5. 验证检索结果显示（相关文档片段）
6. 验证生成回答内容
7. 检查引用来源和相关性

### 高级功能测试
1. 混合检索模式切换（语义+关键词）
2. 查询历史记录查看
3. 结果重新排序或过滤
4. 导出查询结果
5. 批量文档处理

## 测试断言验证

### 功能正确性
- 查询结果与问题相关
- 生成的回答基于检索到的文档
- 引用来源准确可追溯
- 文档内容正确解析

### 用户体验
- 界面响应时间合理（<3秒）
- 加载状态清晰显示
- 错误信息友好提示
- 界面布局在不同屏幕尺寸下正常

### 数据完整性
- 上传的文档完整保存
- 向量化过程无数据丢失
- 检索结果包含所有相关信息
- 生成的回答保持原文语义

## 局限性处理

### 文件上传测试
- 使用测试用的小文件避免超时
- 对于大文件上传，验证UI响应即可
- 测试多种文件格式支持

### 动态内容等待
- 使用智能等待策略
- 监控加载状态指示器
- 设置合理的超时时间

### 复杂交互验证
- 分步骤验证复杂流程
- 结合API测试验证后端逻辑
- 使用屏幕截图记录关键状态

## 证据收集
- 每个关键步骤的屏幕截图
- 网络请求和响应日志
- 控制台错误信息检查
- 性能指标（加载时间、响应时间）